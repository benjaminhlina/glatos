<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Read data from a GLATOS project workbook — read_glatos_workbook • glatos</title>

<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous" />
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script>

<!-- sticky kit -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>



<meta property="og:title" content="Read data from a GLATOS project workbook — read_glatos_workbook" />

<meta property="og:description" content="Read data from a GLATOS project workbook (xlsm file) and return a list of
class glatos_workbook." />
<meta name="twitter:card" content="summary" />



<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->


  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">glatos</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.3.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/data_loading.html">Data loading methods for the R package glatos</a>
    </li>
    <li>
      <a href="../articles/data_requirements.html">Data requirements of the R package glatos</a>
    </li>
    <li>
      <a href="../articles/receiver_efficiency.html">Receiver Efficiency Index</a>
    </li>
    <li>
      <a href="../articles/residence_index.html">Residence Index</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      
      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Read data from a GLATOS project workbook</h1>
    
    <div class="hidden name"><code>read_glatos_workbook.Rd</code></div>
    </div>

    <div class="ref-description">
    
    <p>Read data from a GLATOS project workbook (xlsm file) and return a list of
class <code>glatos_workbook</code>.</p>
    
    </div>

    <pre class="usage"><span class='fu'>read_glatos_workbook</span>(<span class='no'>wb_file</span>, <span class='kw'>read_all</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>, <span class='kw'>wb_version</span> <span class='kw'>=</span> <span class='kw'>NULL</span>)</pre>
    
    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>wb_file</th>
      <td><p>A character string with path and name of workbook in standard
GLATOS format (*.xlsm). If only file name is given, then the file must be
located in the working directory. File must be a standard GLATOS file
(e.g., <em>xxxxx_GLATOS_YYYYMMDD.xlsm</em>) submitted via GLATOSWeb Data
Portal <a href='http://glatos.glos.us'>http://glatos.glos.us</a>.</p></td>
    </tr>
    <tr>
      <th>read_all</th>
      <td><p>If TRUE, then all columns and sheets (e.g., user-created
"project-specific" columns or sheets) in the workbook will be imported. If
FALSE (default value) then only columns and sheets in the standard GLATOS
workbook will be imported (project-specific columns will be ignored.)</p></td>
    </tr>
    <tr>
      <th>wb_version</th>
      <td><p>An optional character string with the workbook version
number. If NULL (default value) then version will be determined by
evaluating workbook structure. Currently, the only allowed values are
<code>NULL</code> and <code>"1.3"</code>. Any other values will trigger an error.</p></td>
    </tr>
    </table>
    
    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>A list of class <code>glatos_workbook</code> with three elements (described
  below) containing data from the standard GLATOS Workbook sheets. If
  <code>read_all = TRUE</code>, then additional elements will be added with names
  corresponding to non-standard sheet names.</p><dl class='dl-horizontal'>
  <dt>metadata</dt><dd><p>A list with data about the project and workbook.</p></dd>
  <dt>animals</dt><dd><p>A data frame of class <code>glatos_animals</code> with data about
  tagged animals.</p></dd> 
  <dt>receivers</dt><dd><p>A data frame of class <code>glatos_receivers</code> with data
  about telemetry receivers.</p></dd>
</dl>

    
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>In the standard glatos workbook (v1.3), data in workbook sheets
  'Deployment', 'Recovery', and 'Location' are merged on columns
  'GLATOS_PROJECT', 'GLATOS_ARRAY', 'STATION_NO', 'CONSECUTIVE_DEPLOY_NO',
  AND 'INS_SERIAL_NO' to produce the output data frame <code>receivers</code>. Data
  in workbook sheets 'Project' and 'Tagging' are passed through to new data
  frames named 'project' and 'animals', respectively, and data from workbook
  sheet 'Proposed' is not included in result. If <code>read_all = TRUE</code> then
  each sheet in workbook will be included in result.</p>
<p>Data are read from the input file using
  <a href='https://www.rdocumentation.org/packages/openxlsx/topics/readWorkbook'>readWorkbook</a> in the package 'openxlsx' package. If
  <code>read_all = TRUE</code> then the type of data in each user-defined column
  (and sheet) will be 'guessed' by <a href='https://www.rdocumentation.org/packages/openxlsx/topics/readWorkbook'>readWorkbook</a>. Therefore,
  if <code>read_all = TRUE</code> then the structure of those columnns should be
  carefully reviewed in the result. See <a href='https://www.rdocumentation.org/packages/openxlsx/topics/readWorkbook'>readWorkbook</a> for
  details.</p>
<p>Column <code>animal_id</code> is considered a required column by many
  other functions in this package, so it will be created if any records are
  <code>NULL</code>. When created, it will be constructed from <code>tag_code_space</code>
  and <code>tag_id_code</code>, separated by '-'.</p>
<p>Timezone attribute of all timestamp columns (class <code>POSIXct</code>)
  in output will be "UTC" and all 'glatos-specific' timestamp and timezone
  columns will be omitted from result.</p>
    
    <h2 class="hasAnchor" id="note"><a class="anchor" href="#note"></a>Note</h2>

    <p><strong><em>On warnings and errors about date and timestamp
  formats.</em></strong> Date and time columns are sometimes stored as text in Excel.
  When those records are loaded by this function, there are two possible
  outcomes. <br />
  <br />
  1. If the records are formatted according to the GLATOS Data Dictionary
  specification (e.g., "YYYY-MM-DD" for dates and "YYYY-MM-DD HH:MM" for
  timestamps; see <a href='https:\glatos.glos.us'>https:\glatos.glos.us</a>) those records should be
  properly loaded into R, but the user is encouraged to verify that they were
  loaded correctly, so a warning points the user to those records in the
  workbook. Users may want to format as custom date in the workbook to avoid
  warnings in the future. <br />
  <br />
  2. If the format of a date-as-text column is not consistent with GLATOS
  specification, then no data will be loaded and an error will alert the user
  to this condition. <br />
  <br />
  <strong><em>On cells with locked formatting in Excel:</em></strong> Occasionally the
  format of a cell in Excel will be locked. In those cases, it is sometimes
  possible to force date formatting in Excel by (1) highlighting the columns
  that need reformatting, (2) select 'Text-to-columns' in the 'Data' menu,
  (3) select 'Delimited' and 'next', (4) uncheck all delimiters and 'next',
  (5) choose 'Date: YMD' in the 'Column data format' box, and (6) 'Finish'.</p>
    
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><a href='https://www.rdocumentation.org/packages/openxlsx/topics/readWorkbook'>readWorkbook</a></p></div>
    

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='co'>#get path to example GLATOS Data Workbook</span>
<span class='no'>wb_file</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/system.file'>system.file</a></span>(<span class='st'>"extdata"</span>,
  <span class='st'>"walleye_workbook.xlsm"</span>, <span class='kw'>package</span> <span class='kw'>=</span> <span class='st'>"glatos"</span>)

<span class='co'>#note that code above is needed to find the example file</span>
<span class='co'>#for real glatos data, use something like below</span>
<span class='co'>#wb_file &lt;- "c:/path_to_file/HECWL_GLATOS_20150321.csv"</span>

<span class='no'>wb</span> <span class='kw'>&lt;-</span> <span class='fu'>read_glatos_workbook</span>(<span class='no'>wb_file</span>)</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      
      <li><a href="#value">Value</a></li>

      <li><a href="#details">Details</a></li>

      <li><a href="#note">Note</a></li>

      <li><a href="#see-also">See also</a></li>
      
      <li><a href="#examples">Examples</a></li>
    </ul>

    <h2>Author</h2>
    <p>C. Holbrook <a href='mailto:cholbrook@usgs.gov'>cholbrook@usgs.gov</a></p>
  </div>
</div>

      <footer>
      <div class="copyright">
  <p>Developed by Christopher Holbrook, Todd Hayden, Thomas Binder, Jon Pye, Alex Nunes.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.3.0.</p>
</div>
      </footer>
   </div>

  

  </body>
</html>

