context("Check receiver_efficiency")

# Actual results
#get path to example detection and deployment files

#otn example
det_file <- system.file("extdata", "hfx_detections.csv",
                        package = "glatos")

dep_file <- system.file("extdata", "hfx_deployments.csv",
                        package = "glatos")

hfx_detections <- glatos::read_otn_detections(det_file)
hfx_deployments <- glatos::read_otn_deployments(dep_file)

hfx_rei <- glatos::REI(hfx_detections,hfx_deployments)


#glatos example
det_file <- system.file("extdata", "walleye_detections.csv",
                        package = "glatos")

dep_file <- system.file("extdata", "sample_receivers.csv",
                        package = "glatos")


glatos_dets <- glatos::read_glatos_detections(det_file)
glatos_deps <- glatos::read_glatos_receivers(dep_file)


glatos_rei <- glatos::REI(glatos_dets, glatos_deps)


#Define expected results

hfx_receiver_efficiency_index <- 
  structure(list(station = c("HFX001", "HFX002", "HFX003", "HFX004", 
"HFX005", "HFX006", "HFX007", "HFX008", "HFX009", "HFX010", "HFX011", 
"HFX012", "HFX013", "HFX014", "HFX015", "HFX016", "HFX017", "HFX018", 
"HFX019", "HFX020", "HFX021", "HFX022", "HFX023", "HFX024", "HFX025", 
"HFX026", "HFX027", "HFX028", "HFX029", "HFX030", "HFX031", "HFX032", 
"HFX033", "HFX034", "HFX035", "HFX036", "HFX037", "HFX038", "HFX039", 
"HFX040", "HFX041", "HFX042", "HFX043", "HFX044", "HFX045", "HFX046", 
"HFX047", "HFX048", "HFX049", "HFX050", "HFX051", "HFX052", "HFX053", 
"HFX054", "HFX055", "HFX056", "HFX057", "HFX058", "HFX059", "HFX060", 
"HFX061", "HFX062", "HFX063", "HFX064", "HFX065", "HFX066", "HFX067", 
"HFX068", "HFX069", "HFX070", "HFX071", "HFX072", "HFX073", "HFX074", 
"HFX075", "HFX076", "HFX077", "HFX078", "HFX079", "HFX080", "HFX081", 
"HFX082", "HFX083", "HFX084", "HFX085", "HFX086", "HFX087", "HFX088", 
"HFX089", "HFX090", "HFX091", "HFX092", "HFX093", "HFX094", "HFX095", 
"HFX096", "HFX097", "HFX098", "HFX099", "HFX100", "HFX101", "HFX102", 
"HFX103", "HFX104", "HFX105", "HFX106", "HFX107", "HFX108", "HFX109", 
"HFX110", "HFX111", "HFX112", "HFX113", "HFX114", "HFX115", "HFX116", 
"HFX117", "HFX118", "HFX119", "HFX120", "HFX121", "HFX122", "HFX123", 
"HFX124", "HFX125", "HFX126", "HFX127", "HFX128", "HFX129", "HFX130", 
"HFX131", "HFX132", "HFX133", "HFX134", "HFX135", "HFX136", "HFX137", 
"HFX138", "HFX139", "HFX140", "HFX141", "HFX142", "HFX143", "HFX144", 
"HFX145", "HFX146", "HFX147", "HFX148", "HFX149", "HFX150", "HFX151", 
"HFX152", "HFX153", "HFX154", "HFX155", "HFX156", "HFX157", "HFX158", 
"HFX159", "HFX160", "HFX161", "HFX162", "HFX163", "HFX164", "HFX165", 
"HFX166", "HFX167", "HFX168", "HFX169", "HFX170", "HFX171", "HFX172", 
"HFX173", "HFX174", "HFX175", "HFX176", "HFX177", "HFX178", "HFX179", 
"HFX180", "HFX181", "HFX182", "HFX183", "HFX184", "HFX185", "HFX186", 
"HFX187", "HFX188", "HFX189", "HFX190", "HFX191", "HFX192", "HFX193", 
"HFX194", "HFX195", "HFX196", "HFX197", "HFX198", "HFX199", "HFX200", 
"HFX201", "HFX202", "HFX203", "HFX204", "HFX205", "HFX206", "HFX207", 
"HFX208", "HFX209", "HFX210", "HFX211", "HFX212", "HFX213", "HFX214", 
"HFX215", "HFX216", "HFX217", "HFX218", "HFX219", "HFX220", "HFX221", 
"HFX222", "HFX223", "HFX224", "HFX225", "HFX226", "HFX227", "HFX228", 
"HFX229", "HFX230", "HFX231", "HFX232", "HFX233", "HFX234", "HFX235", 
"HFX236", "HFX237", "HFX238", "HFX239", "HFX240", "HFX241", "HFX242", 
"HFX243", "HFX244", "HFX245", "HFX246", "HFX247", "HFX248", "HFX249", 
"HFX250", "HFX251", "HFX252", "HFX253", "HFX254", "HFX255", "HFX256"
), latitude = c(44.4784398019802, 44.4723024482759, 44.4666508064516, 
44.4610676153846, 44.4551916666667, 44.4495551342282, 44.4435718960674, 
44.4376724347826, 44.4322934263959, 44.4263002160494, 44.4201856701031, 
44.4146651076321, 44.4087329514563, 44.403021013986, 44.3970783737024, 
44.3914915625, 44.3855497835498, 44.3798768561485, 44.3741773574045, 
44.3684355159648, 44.362973256262, 44.3571419512195, 44.3512523391089, 
44.3451172286374, 44.3393246019629, 44.3340587029624, 44.3277182426128, 
44.3226188888889, 44.3165625172414, 44.3105936758893, 44.3047808, 
44.2990175064488, 44.2931161571125, 44.2873048487141, 44.2816719847328, 
44.2195895147679, 44.2846399468085, 43.6516402863962, 44.2586467034068, 
44.252981980116, 44.2472888926175, 44.242369331307, 44.2362211627907, 
44.230495298913, 44.2206545991561, 44.21905, 44.2132852822581, 
44.2071202259887, 44.2020485818182, 44.1964227734375, 44.1907233548387, 
44.1850885384615, 44.1794826277372, 44.17387, 44.1681454153846, 
44.1626348537005, 44.15686, 44.1513683488372, 44.1135019434629, 
44.1398208445946, 44.1342792727273, 44.1288728384279, 44.1229017255717, 
44.1173704, 44.1116368674699, 44.1058232432432, 44.1000438741722, 
44.0945382736156, 44.0881734986945, 44.0832373353752, 44.0776513176265, 
44.0720459965035, 44.06625, 44.05994, 44.05354, 44.04911, 44.0384475431034, 
44.134063537415, 44.0279, 44.02162, 44.01518, 44.00873, 44.0027, 
43.99641, 43.98999, 43.98365, 43.97717, 43.97074, 43.96465, 43.95812, 
43.95173, 43.94532, 43.93904, 43.93265, 43.92633, 43.91994, 43.9134, 
43.90728, 43.90088, 43.89448, 43.88814, 43.88175, 43.87541, 43.86916, 
43.86264, 43.85627, 43.85201, 43.84738, 43.84366, 43.83852, 43.83428, 
43.83007, 43.82618, 43.82182, 43.81778, 43.8131980645161, 43.80840968, 
43.804304333996, 43.7998687804878, 43.7932530808081, 43.7865957142857, 
43.7798796629213, 43.7733213095238, 43.7667, 43.76021, 43.752952, 
43.74669703125, 43.73983, 43.7332184210526, 43.7267892307692, 
43.7199793103448, 43.713423125, 43.70638, 43.6998570588235, 43.6926779710145, 
43.685098974359, 43.6776485714286, 43.6704656521739, 43.6630838461538, 
43.65541, 43.64797, 43.640729, 43.63336, 43.627094, 43.6207466666667, 
43.614184, 43.6076310169492, 43.60166, 43.5954530357143, 43.5890148387097, 
43.5825766129032, 43.5761444067797, 43.5696846341463, 43.5634651724138, 
43.5571024, 43.5506, 43.5444, 43.5381164646465, 43.531735, 43.52528, 
43.51892, 43.5126674358974, 43.506225, 43.4998591891892, 43.4926146666667, 
43.48532, 43.47827, 43.47112, 43.46386, 43.45657, 43.4495, 43.4421, 
43.43491, 43.42778, 43.42051, 43.41323, 43.40624, 43.39898, 43.3919, 
43.3839113559322, 43.37737, 43.36992, 43.3631, 43.35567, 43.34852, 
43.34131, 43.33252, 43.32693, 43.31976, 43.31267, 43.30535, 43.29809, 
43.29098, 43.28379, 43.27641, 43.26901, 43.26221, 43.25488, 43.24799, 
43.24071, 43.23345, 43.22632, 43.21909, 43.21196, 43.20489, 43.1974648648649, 
43.19034, 43.18252, 43.17557, 43.1687, 43.16141, 43.15449, 43.14712, 
43.13988, 43.13266, 43.12533, 43.11846, 43.11101, 43.10386, 43.09654, 
43.08928, 43.08235, 43.07501, 43.06784, 43.06054, 43.05329, 43.04632, 
43.0391, 43.03187, 43.02455, 43.01746, 43.01016, 43.00303, 42.9958, 
42.98856, 42.98146, 42.97416, 42.96708, 42.95967, 42.95246, 42.94533, 
42.93799, 42.93086, 42.92372, 42.916286744186, 42.90925, 42.90203, 
42.89487, 42.88764, 42.88042, 42.87317, 42.86598, 42.8588, 42.85166, 
42.84442, 42.83737), longitude = c(-63.5333763366337, -63.5269339655172, 
-63.5200411693548, -63.5140228461538, -63.5077485087719, -63.5009823825503, 
-63.4941791432584, -63.4880379130435, -63.4813606218274, -63.4751074382716, 
-63.4685693519882, -63.4621277886497, -63.4558474174757, -63.4487153146853, 
-63.4426002076125, -63.4360236979167, -63.4298772438672, -63.4230945475638, 
-63.4168982940869, -63.4101426654327, -63.4023615992293, -63.3974944850948, 
-63.3909311262376, -63.3842537759815, -63.377850348964, -63.3713183827062, 
-63.3647795489891, -63.3597477777778, -63.3519217931035, -63.3453266007905, 
-63.3386898434783, -63.3323952450559, -63.3259785138004, -63.3197691906203, 
-63.3130440330789, -63.9073214345992, -63.3202238297872, -64.9284846300716, 
-63.2876916533066, -63.2810401077051, -63.2749722818792, -63.2681703951368, 
-63.2620515742397, -63.2564305434783, -63.2499893670886, -63.2434346047431, 
-63.2371794354839, -63.2312440112994, -63.2246610545455, -63.2189780078125, 
-63.2126161935484, -63.2062673461538, -63.2000200729927, -63.1937021282401, 
-63.1875617846154, -63.1811118072289, -63.1749595793499, -63.1685094883721, 
-63.2591738162544, -63.1561848141892, -63.1495723636364, -63.1436744323144, 
-63.1375132016632, -63.1309038909091, -63.1247902409639, -63.1182235735736, 
-63.112007615894, -63.1054898045603, -63.1005381462141, -63.0933156814701, 
-63.0868376178011, -63.0806824125874, -63.07414, -63.0792, -63.08357, 
-63.08809, -63.0969261206897, -62.9843613605442, -63.10217, -63.10683, 
-63.11176, -63.11657, -63.1213, -63.12604, -63.13182, -63.1366, 
-63.14147, -63.14619, -63.15083, -63.15571, -63.16059, -63.16522, 
-63.16999, -63.17481, -63.17962, -63.18439, -63.1888349367089, 
-63.19393, -63.19874, -63.20349, -63.20832, -63.21309, -63.21791, 
-63.22261, -63.22745, -63.23223, -63.23979, -63.2469, -63.25558, 
-63.2625, -63.27016, -63.27802, -63.28576, -63.29423, -63.30154, 
-63.3093506451613, -63.31715816, -63.3255161232604, -63.3331092195122, 
-63.3373797979798, -63.34226, -63.3464540449438, -63.3506098809524, 
-63.35541, -63.36019, -63.364389, -63.3691428125, -63.3727, -63.3775568421053, 
-63.3824750769231, -63.3866017241379, -63.391106875, -63.39574, 
-63.4000829411765, -63.3999888405797, -63.4000625641026, -63.3999214285714, 
-63.399828115942, -63.3997935897436, -63.39962, -63.39958, -63.3996306666667, 
-63.39955, -63.404484, -63.4092066666667, -63.414138, -63.4190913559322, 
-63.42339, -63.42824375, -63.4330585483871, -63.4379172580645, 
-63.4428172881356, -63.4475014634146, -63.4522996551724, -63.4571352, 
-63.46193, -63.4665314285714, -63.4712249494949, -63.4762175, 
-63.481, -63.48577, -63.4904820512821, -63.495327631579, -63.500117027027, 
-63.500012, -63.49993, -63.49999, -63.50007, -63.49996, -63.50004, 
-63.50019, -63.50004, -63.49997, -63.50003, -63.50009, -63.50002, 
-63.50004, -63.49997, -63.49997, -63.4988177966102, -63.50005, 
-63.50012, -63.50003, -63.50009, -63.50005, -63.49999, -63.49986, 
-63.50003, -63.49999, -63.50004, -63.5, -63.50006, -63.50002, 
-63.50001, -63.49989, -63.4998, -63.5, -63.49993, -63.49988, 
-63.5, -63.50009, -63.5001, -63.5001, -63.5, -63.50003, -63.4998275675676, 
-63.49998, -63.49755, -63.4989, -63.50024, -63.49966, -63.49789, 
-63.50007, -63.49985, -63.49995, -63.49983, -63.50012, -63.4999, 
-63.49987, -63.50001, -63.5, -63.50011, -63.50005, -63.50017, 
-63.49996, -63.49983, -63.50005, -63.50001, -63.50005, -63.50002, 
-63.50025, -63.49989, -63.5001, -63.5, -63.49994, -63.50004, 
-63.49993, -63.50002, -63.49997, -63.49992, -63.49998, -63.49992, 
-63.49999, -63.50004, -63.4993546511628, -63.49999, -63.49995, 
-63.50002, -63.50002, -63.49993, -63.50004, -63.49995, -63.49997, 
-63.49995, -63.50003, -63.49981), rei = c(0.00580962595813294, 
0.00367974146481378, 0.00539465267540915, 0.00237666516469075, 
0.000616975249894385, 0.00605000338855328, 0.0102685716970085, 
0.00940763294356754, 0.0154615103597092, 0.0045924944994297, 
0.00987950455711003, 0.00710948303275562, 0.0108631411736046, 
0.0133844375869352, 0.0103145677269121, 0.0151580743135218, 0.0109762569773178, 
0.0175116715379229, 0.0193365593241384, 0.0222672565967032, 0.0221161897269833, 
0.0178835807361363, 0.0180370531995448, 0.0172777683805761, 0.0144151936180136, 
0.0153620948583662, 0.00844098548747172, 0.00581493964041172, 
0.0124007237265634, 0.021779150551173, 0.0103719793984492, 0.0246520082878421, 
0.0251013938555892, 0.0309982419752233, 0.0369323090167397, 0.00347540124281167, 
0.00602265863414448, 0.018715344304749, 0.0207190190354482, 0.0255471611243613, 
0.0195522377469652, 0.00413253545156261, 0.0212486376004305, 
0.00599967097300492, 0.0047843815878331, 0.0232577804139694, 
0.0196386309600345, 0.00400984628733441, 0.00561428454528765, 
0.00692997841256096, 0.00824428466321907, 0.0175639108042493, 
0.0132983896089316, 0.0147232170670315, 0.013172933103187, 0.0177431343838845, 
0.010036520459571, 0.00815467287340147, 0.00676259482025538, 
0.00746018150231508, 0.00165326390894481, 0.0149114018256484, 
0.0127129259154567, 0.00885364483397874, 0.0109147159997835, 
0.00581317114355189, 0.00234539325462903, 0.00736448661001295, 
0.00300540487039514, 0.00309126598444988, 0.00545517526667626, 
0.00590693196844789, 0.00343520698422078, 0.00403825740602252, 
0.00389323458211689, 0.00479835115118015, 0.00177387997563415, 
0.00466563653309299, 0.000875488631092519, 0.00131323294663878, 
0.00172403915045911, 0.00202035837944427, 0.00272748381224977, 
0.00214663077815954, 0.00243284821524748, 0.00266081996345123, 
0.000814877879709191, 0.000925997590578626, 0.00170720283063041, 
0.00121221502766657, 0.00176781358201374, 0.00243116458326461, 
0.00194627857219799, 0.000673452793148092, 0.00105058635731102, 
0.000963037494201771, 0.000353976052508596, 0.0013095991499966, 
0.00096215447754852, 0.00096215447754852, 0.000668162831630916, 
0.000601346548467825, 0.000280628389284985, 0.00024053861938713, 
0.000668162831630916, 0.0013095991499966, 0.000808477026273409, 
0.000180403964540347, 5.34530265304733e-05, 0.000467713982141642, 
0.000668162831630917, 0.000534530265304733, 0.000751683185584781, 
0.000601346548467825, 0.000601346548467825, 0.00132942570800301, 
0.00132942570800301, 0.00147259463040333, 0.00261794600960592, 
0.00472457443921068, 0.00157485814640356, 0.00159531084960361, 
0.00112489867600254, 0.000102263516000231, 3.06790548000694e-05, 
0.000284757807643562, 0.000681756773334875, 0.000165760915675258, 
0.00088405821693471, 0.000696195845836084, 0.00016122805496926, 
0.000138134096396048, 0.000270742828936255, 0.000663043662701033, 
0.000994565494051549, 0.00088333893879963, 8.8405821693471e-05, 
0.000276268192792097, 0.000117874428924628, 0.000165760915675258, 
6.63043662701033e-05, 0.000206280250618099, 0.000138134096396048, 
1.47343036155785e-05, 1.22867720705463e-05, 2.76452371587292e-05, 
0.000214700436513799, 0.00043003702246912, 0.00101365869582007, 
0.000622017836071406, 0.00128725051071688, 0.00043003702246912, 
0.000232685362859043, 0.000735571720409645, 0.000552904743174583, 
0.000122867720705463, 0.000552904743174583, 0.00110580948634917, 
0.000387033320222208, 0.000115188488161372, 0.000184301581058194, 
0.000184301581058194, 0.000393176706257481, 0.000258022213481472, 
0.000301025915728384, 0.000301025915728384, 0.000234092734005368, 
0.000156061822670245, 0.000156061822670245, 5.09589625045699e-05, 
0.000171986498452923, 0.000119435068370086, 7.96233789133905e-05, 
7.64384437568548e-05, 6.36987031307124e-05, 0.00010191792500914, 
7.64384437568548e-05, 0.000445890921914987, 0.000445890921914987, 
0.000313988238250925, 0.000458630662541129, 0.00031212364534049, 
0.000119435068370086, 7.64384437568548e-05, 0.000390154556675613, 
0.000229315331270565, 0.000200766563804027, 0.000267688751738703, 
5.09883336645149e-05, 0.000267688751738703, 0.000267688751738703, 
0.000458895002980634, 9.56031256209654e-05, 7.64825004967723e-05, 
7.64825004967723e-05, 2.86809376862896e-05, 6.37354170806436e-06, 
5.73618753725793e-05, 0.000229447501490317, 0.000717023442157241, 
0.000750323083318946, 0.000675290774987051, 0.000210090463329305, 
0.000150064616663789, 0.000240103386662063, 0.000675290774987051, 
0.00032013784888275, 8.00344622206876e-05, 5.78621242857122e-05, 
1.66738462959766e-06, 1.50064616663789e-05, 0.000129731839180628, 
0.000175075386107754, 0.000210090463329305, 0.000194489105639301, 
0.000138920789742358, 4.93940585750605e-05, 0.000345758410025423, 
0.000345758410025423, 0.000444546527175544, 0.000222273263587772, 
0.000302538608772245, 0.000302538608772245, 0.000138920789742358, 
0.000115767324785298, 0.000296364351450363, 0.000162074254699417, 
0.00100331681480592, 0.00075435065735447, 0.000432198012531779, 
0.000491159035814985, 0.000284170585007241, 0.000105248364817497, 
1.75413941362495e-06, 1.75413941362495e-06, 0.000221021566116743, 
0.000157872547226245, 5.61324612359983e-05, 0.000171905662535245, 
0.000171905662535245, 3.1574509445249e-05, 0.000368369276861239, 
0.000589390842977982, 0.000463092805196986, 0.000197576234300242, 
0.000561324612359983, 0.00171028592828432, 0.000877069706812474, 
0.00125420968074184, 0.00171905662535245, 0.00137524530028196, 
0.00100336774459347, 0.000993907960703525, 0.00136822874262746, 
0.00136822874262746, 0.00147347710744496)), class = "data.frame", 
row.names = c(NA, 
-256L))

glatos_receiver_efficiency_index <- 
  structure(list(station = c("DRF-004", "DRL-004", "DRL-010", "DRL-011", 
"DRU-001", "DRU-002", "DRU-004", "DRU-005", "DRU-006", "DRU-007", 
"DRU-008", "FMP-001", "FMP-002", "FMP-003", "MAU-001", "MAU-002", 
"MAU-003", "MAU-011", "MAU-012", "OSC-001", "OSC-002", "OSC-003", 
"PRS-001", "PRS-002", "PRS-003", "RAR-001", "RAR-002", "RAR-003", 
"RAR-004", "RAR-005", "SBI-001", "SBI-002", "SBI-003", "SBI-007", 
"SBI-008", "SBI-009", "SBI-010", "SBI-011", "SBI-012", "SBI-013", 
"SBI-014", "SBI-015", "SBI-016", "SBI-017", "SBI-018", "SBI-019", 
"SBI-020", "SBO-001", "SBO-002", "SBO-003", "SBO-004", "SBO-005", 
"SBO-006", "SBO-007", "SBO-008", "SBO-009", "SBO-010", "SBO-012", 
"SCL-001", "SCL-002", "SCL-004", "SCL-005", "SCM-001", "SCM-002", 
"SCM-003", "SGR-001", "SHR-001", "STG-006", "THB-003", "THB-004", 
"THB-005", "THB-006", "THB-007", "THB-008", "THB-009", "THB-010", 
"THB-011", "THB-014", "THB-015", "THB-016", "TSR-001", "TTB-001"
), latitude = c(42.24937, 42.12746, 42.0769, 42.09637, 42.35693, 
42.35278, 42.35469, 42.35085, 42.34447, 42.33541, 42.33204, 45.48983, 
45.49914, 45.50756, 41.57098, 41.57417, 41.57612, 41.63532, 41.6443, 
44.45198, 44.45157, 44.45144, 45.33385, 45.33986, 45.34603, 41.63719, 
41.63648, 41.64165, 41.63846, 41.63288, 44.17873, 44.1771329411765, 
44.17255, 44.15439, 44.14975, 44.14524, 44.14066, 44.13613, 44.13149, 
44.12695, 44.12241, 44.11781, 44.11329, 44.10875, 44.10408, 44.09961, 
44.09214, 44.2464643333333, 44.2417948571429, 44.2370746835443, 
44.2323153731343, 44.22771, 44.2229290625, 44.21828, 44.21342, 
44.2088, 44.2041, 44.19472, 42.61334, 42.61462, 42.55267, 42.54992, 
42.77913, 42.76994, 42.6352, 43.61235, 43.37698, 44.71315, 44.90447, 
44.91327, 44.92215, 44.9308, 44.93957, 44.94818, 44.95714, 44.96585, 
44.97452, 45.00077, 45.0095, 45.01824, 41.62433, 43.387016744186
), longitude = c(-83.11824, -83.11873, -83.12096, -83.11681, 
-82.93016, -82.92844, -82.94291, -82.93774, -82.93849, -83.00901, 
-83.00352, -83.91048, -83.9059, -83.90137, -83.61776, -83.60687, 
-83.61071, -83.53083, -83.53426, -83.31861, -83.30572, -83.29315, 
-83.45837, -83.44852, -83.43862, -82.97453, -82.96842, -82.97328, 
-82.98027, -82.97516, -83.5477078947368, -83.5417041176471, -83.5309, 
-83.48782, -83.47694, -83.46626, -83.45551, -83.44487, -83.43403, 
-83.42327, -83.41245, -83.40174, -83.39079, -83.38007, -83.36923, 
-83.35869, -83.35204, -83.445841, -83.4350991428571, -83.4244859493671, 
-83.4138805970149, -83.4031, -83.3923328125, -83.38175, -83.37122, 
-83.36047, -83.34985, -83.32868, -82.52119, -82.52926, -82.58909, 
-82.58493, -82.47231, -82.47034, -82.49834, -83.8609006451613, 
-83.99115, -83.2011, -83.31385, -83.31073, -83.30769, -83.30461, 
-83.30165, -83.29828, -83.29516, -83.29228, -83.28925, -83.27969, 
-83.27665, -83.27346, -83.01284, -83.9873130232558), rei = c(0.00123899096401187, 
0.00156294731698745, 0.00141378636972309, 0.00116287547816814, 
0.00168674512427359, 0.001577419051404, 0.00154873870501484, 
0.00347676035819657, 0.00329200497684313, 0.00181235380374077, 
0.00120609739859563, 0.0335136900101571, 0.00645919459911402, 
0.00903773249610781, 0.042590314387908, 0.00900588145647395, 
0.0278709623806351, 0.127770943163724, 0.0448319098820085, 0.00146863153061752, 
0.00146863153061752, 0.00104676655945703, 0.00740701119789705, 
0.0126977334821092, 0.0105814445684244, 0.106732354128733, 0.0903119919550821, 
0.0985221730419077, 0.0985221730419077, 0.106732354128733, 0.00205564111676178, 
0.00217020710256856, 0.00102627263585321, 0.000953069972316823, 
0.000939924179595212, 0.00187984835919042, 0.00187725903638162, 
0.00187725903638162, 0.00187725903638162, 0.00187725903638162, 
0.000938629518190811, 0.00187725903638162, 0.00100360092813922, 
0.00100508116549635, 0.000938629518190811, 0.000945138738150525, 
0.00100508116549635, 0.00216103075118349, 0.00373906738110578, 
0.00285920991695047, 0.00285920991695047, 0.00190613994463365, 
0.00285920991695047, 0.000953069972316823, 0.000953069972316823, 
0.000957085716582203, 0.000957085716582203, 0.000957085716582203, 
0.00176998709144553, 0.00176998709144553, 0.00176998709144553, 
0.0033568720699829, 0.00117897064049572, 0.00117897064049572, 
0.0016224881671584, 0.00410509054341282, 0.00327617802983908, 
0.00109733499228104, 0.0011008805011414, 0.00104196487799163, 
0.00104196487799163, 0.00208392975598327, 0.00104196487799163, 
0.000994810263075224, 0.000994810263075224, 0.000994810263075224, 
0.0011008805011414, 0.000994810263075224, 0.00198962052615045, 
0.00194977118800151, 0.0574712676077795, 0.00411335028293679)), 
class = "data.frame", row.names = c(NA, 
-82L))


# Test using testthat library
test_that("REI gives expected results for the halifax line", {
  # Check if expected and actual results are the same
  expect_equal(hfx_rei, hfx_receiver_efficiency_index)
})

# Test using testthat library
test_that("REI gives expected results for the GLATOS samples", {
  # Check if expected and actual results are the same
  expect_equal(glatos_rei, glatos_receiver_efficiency_index)
})